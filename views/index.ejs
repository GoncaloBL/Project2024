<% layout('/layouts/boilerplate') -%>
    <link rel="stylesheet" href="/stylesheets/index.css">

    <div id="carouselMain" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <% data.forEach((item, i)=> { %>
                <button type="button" data-bs-target="#carouselMain" data-bs-slide-to=<%=i %>
                    class= <%= i===0 ? 'active' : null %> aria-current="true" aria-label="Slide <%= i %>"></button>
                <% }) %>
        </div>
        <div class="carousel-inner">
            <% data.forEach((item, i)=> { %>
                <% if (item.image[0]) { %>
                    <div class="carousel-item image-div <%= i===0 ? 'active' : null %>">
                        <div class="d-flex justify-content-center">
                            <img src="<%= item.image[0]%>" class=" w-100  carousel-image">
                        </div>
                    </div>
                    <% } %>
                        <% }) %>

        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselMain" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselMain" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>


    <div id="arrowdown">
          <div class="scroll">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none"></path>
                <path d="M11.9997 13.1716L7.04996     8.22186L5.63574 9.63607L11.9997 16L18.3637 9.63607L16.9495 8.22186L11.9997 13.1716Z" fill="rgba(28,28,30,1)">
                </path>
            </svg>
          </div> 
      </div>

    <% for (let item of data) { %>
        
        <div class="card m-4">
            <div class="row">
                
                <div class="col-lg-3 col-md-4" style="display: flex; justify-content: center;">
                    <% if(!item.image[0]) { %>
                        <img class="img-fluid product-image" src="noimg.jpg" alt="">
                        <% } else { %>
                            <img class="img-fluid product-image" src="<%=item.image[0] %>" alt="">
                            <% } %>
                </div>
                <div class="col-lg-5 col-md-8">
                    <div class="card-body">
                        <h5 class="card-title">
                            <%= item.title %>
                        </h5>
                        <p class="class-text text-muted">
                            <%= item.location %>
                        </p>
                        <p class="card-text">
                            <%= item.description %>
                        </p>
                        <a class="btn btn-primary" href="/product/<%= item._id%>">See more</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-8 mt-3" >
                    <h5>Reviews</h5>
                    <% if (item.reviews.length<1){ %>
                        <p>No reviews yet</p>
                        <%} else {  %>
                            <% for (let i=0; i< Math.min(item.reviews.length, 3); i++){ %>
                                <p>
                                    <span style="position: relative; top: 6px; font-size: 1.5rem; color: #FC0;"><b><%= item.reviews[0].rating %></b></span><img src="iconStar.png" style="height: 30px;">
                                    <%= item.reviews[0].body %>
                                </p>
                                <% } %>
                                <% } %>
                        </div>


            </div>
        </div>
        <% } %>


            <script>
                function scrollFunction() {
                    document.getElementById("arrowdown").style.visibility = "hidden";
                }

                window.onscroll = scrollFunction;
            </script>